# Patches to add IAM role ARNs to ServiceAccounts
# =============================================================================
# NOTE: This file uses placeholder variables that must be substituted before
# applying. Use envsubst in CI/CD pipeline:
#   envsubst < service-account-patches.yaml | kubectl apply -f -
#
# Required environment variables:
#   - AWS_ACCOUNT_ID: Your AWS account ID
#   - ENVIRONMENT: Environment name (e.g., dev, staging, prod)
# =============================================================================
apiVersion: v1
kind: ServiceAccount
metadata:
  name: identity-service-sa
  namespace: neobank
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::${AWS_ACCOUNT_ID}:role/neobank-${ENVIRONMENT}-identity-service-role
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: ledger-service-sa
  namespace: neobank
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::${AWS_ACCOUNT_ID}:role/neobank-${ENVIRONMENT}-ledger-service-role
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: payment-service-sa
  namespace: neobank
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::${AWS_ACCOUNT_ID}:role/neobank-${ENVIRONMENT}-payment-service-role
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: card-service-sa
  namespace: neobank
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::${AWS_ACCOUNT_ID}:role/neobank-${ENVIRONMENT}-card-service-role
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: product-service-sa
  namespace: neobank
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::${AWS_ACCOUNT_ID}:role/neobank-${ENVIRONMENT}-product-service-role
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: frontend-sa
  namespace: neobank
  annotations:
    eks.amazonaws.com/role-arn: ""
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: external-secrets-sa
  namespace: neobank
  annotations:
    eks.amazonaws.com/role-arn: "arn:aws:iam::${AWS_ACCOUNT_ID}:role/neobank-${ENVIRONMENT}-external-secrets-role"
